---
title: "실행계획 항목"
order: 3
editable : false
---

## :anchor: 실행계획 항목분석

```sql
EXPLAIN
SELECT * FROM EMPLOYEE
WHERE 1=1
AND EMPLOYEE_NO BETWEEN  100001 AND 200000
```
|id|select_type|table|type|possible_keys|key|key_len|ref|rows|Extra|
|-|-|-|-|-|-|-|-|-|-|
1|SIMPLE|EMPLOYEE|range|PRIMARY|PRIMARY|4||20080|Using where|

결과를 보면 id, select_type, table 등 각 항목들이 있는데 이 항목들이 무엇인지 알아보자.

## :fallen_leaf: id

id는 실행 순서를 표시한다. JOIN할 때는 똑같은 ID로 보여진다.

너무 간단하니 패스!

## :leaves: select_type

SELECT 문의 유형을 출력하는 항목이다. 단순한 SELECT인지, 서브쿼리인지, UNION 인지 정보를 제공한다.

### - SIMPLE

의미 그대로 단순한 SELECT 구문으로만 작성된 쿼리(UNION이나 서브쿼리가 없음)

```sql
EXPLAIN
SELECT EMPLOYEE_NO,BIRTH_DT  FROM EMPLOYEE
```
|id|select_type|table|type|possible_keys|key|key_len|ref|rows|Extra|
|-|-|-|-|-|-|-|-|-|-|
1|SIMPLE|EMPLOYEE|ALL|||||299246||

### - PRIMARY
서브쿼리가 포함된 SQL문일 경우 서브쿼리를 감싸는 쿼리 또는 UNION이 포함된 쿼리일 경우 첫 번째의 SELECT 쿼리에 표시된다.
```sql
EXPLAIN
SELECT
(SELECT EMPLOYEE_NAME FROM EMPLOYEE WHERE EMPLOYEE_NO=EMPLOYEE_NO) AS EMPLOYEE_NAME
FROM DEPARTMENT_EMPLOYEE
WHERE 1=1
AND EMPLOYEE_NO = 10001
```
|id|select_type|table|type|possible_keys|key|key_len|ref|rows|Extra|
|-|-|-|-|-|-|-|-|-|-|
1|PRIMARY|DEPARTMENT_EMPLOYEE|ref|PRIMARY|PRIMARY|4|const|1|Using index|
2|DEPENDENT SUBQUERY|EMPLOYEE|eq_ref|PRIMARY|PRIMARY|4|tuning.DE.EMPLOYEE_NO|1||

부서 사원 테이블이 서브쿼리 밖에 있으므로 select_type이 PRIMARY로 나온것을 확인할 수 있다!

```sql
EXPLAIN
SELECT EMPLOYEE_NO FROM DEPARTMENT_EMPLOYEE D1 WHERE EMPLOYEE_NO = 10001
UNION ALL
SELECT EMPLOYEE_NO FROM DEPARTMENT_EMPLOYEE D2 WHERE EMPLOYEE_NO = 10002
```

id|select_type|table|type|possible_keys|key|key_len|ref|rows|Extra|
|-|-|-|-|-|-|-|-|-|-|
1|PRIMARY    |D1   |ref |PRIMARY      |PRIMARY|4      |const|1   |Using index|
2|UNION      |D2   |ref |PRIMARY      |PRIMARY|4      |const|1   |Using index|

부서 사원 테이블의 D1이 UNION의 첫번째 이므로  PRIMARY로 나온것을 확인함!!

### - SUBQUERY

독립적으로 수행되는 서브쿼리를 의미한다.

```sql
EXPLAIN
SELECT
(SELECT EMPLOYEE_NO FROM DEPARTMENT_EMPLOYEE D1 WHERE EMPLOYEE_NO = 10001) AS EMPLOYEE_NO1
,(SELECT EMPLOYEE_NO FROM DEPARTMENT_EMPLOYEE D2 WHERE EMPLOYEE_NO = 10002)AS EMPLOYEE_NO2
```
id|select_type|table|type|possible_keys|key|key_len|ref|rows|Extra|
|-|-|-|-|-|-|-|-|-|-|
1|PRIMARY    |     |    |             |       |       |     |    |No tables used|
3|SUBQUERY   |D2   |ref |PRIMARY      |PRIMARY|4      |const|1   |Using index   |
2|SUBQUERY   |D1   |ref |PRIMARY      |PRIMARY|4      |const|1   |Using index   |

해당 서브쿼리들은 다른 쿼리랑 상관없이 독립적으로 실행 될 수 있다.

### - DERIVED

FROM 에 작성된 서브쿼리라는 의미이다. (인라이뷰)

```sql
EXPLAIN
SELECT
    E.EMPLOYEE_NO, S.ANNUAL_INCOME
FROM
    EMPLOYEE E
JOIN (
    SELECT S.EMPLOYEE_NO, MAX(ANNUAL_INCOME) AS ANNUAL_INCOME
    FROM SALARY S
    WHERE EMPLOYEE_NO = 10001
) AS S
WHERE 1=1
AND E.EMPLOYEE_NO = S.EMPLOYEE_NO
```
id|select_type|table     |type  |possible_keys|key    |key_len|ref          |rows|Extra      |
|-|-|-|-|-|-|-|-|-|-|
1|PRIMARY|derived2|ALL   |             |       |       |             |17    |Using where|
1|PRIMARY|E         |eq_ref|PRIMARY      |PRIMARY|4      |S.EMPLOYEE_NO|1   |Using index|
2|DERIVED|S         |ref   |PRIMARY      |PRIMARY|4      |const        |17  |           |

서브쿼리로 작성된 급여테이블이 DERIVED 로 표시된 것을 확인!
